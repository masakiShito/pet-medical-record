# 01_画面一覧（改訂版：領域別ページ設計）

## 1. 目的
本ドキュメントは、ペットカルテアプリ（MVP）における画面構成を一覧化し、  
実装時に「どの画面で何をするか」「どこからどこへ遷移するか」を迷わない状態にすることを目的とする。

---

## 2. 改訂の背景（方針変更）
従来は「1日の記録（records）に体調/体重/投薬/通院をまとめて入力する」設計だったが、  
カルテ用途では **通院（診療）を主役** にし、入力・閲覧の体験を軽くするため、以下に方針転換する。

- **ホームをダッシュボード化**（全ペット横断）
- **ペット単位のダッシュボード（ハブ）**を用意し、各領域（通院/体重/投薬）へ誘導する
- 通院/体重/投薬は **それぞれ一覧・登録・詳細（必要なら）** を持つ
- 既存の「まとめて記録」も **ショートカット（任意）** として残せる

※データモデルは当面 `records` 親 + 子要素（weights/medications/vet_visits）を踏襲し、  
画面は「領域別」に分割する（実装負荷を抑えつつUXを改善）。

---

## 3. 前提（MVP方針）
- 認証はMVPでは必須にしない（シングルユーザー想定）
- 削除は論理削除を基本とする（誤操作対策）
- 追加・編集は同一画面で扱う（フォーム共通化）
- 一覧は「振り返りやすさ」を優先し、日付でソート（新しい順）を基本にする

---

## 4. 画面一覧（改訂）

| 画面ID | 画面名 | URL（案） | 目的/概要 | 主な操作 | 関連データ |
|---|---|---|---|---|---|
| S01 | ホーム（全体ダッシュボード） | `/` | 全ペットの直近状況を俯瞰し、領域別（通院/体重/投薬）へ最短誘導 | ペットカード、各領域へ遷移、直近詳細へ | pets / records（サマリ） |
| S02 | ペット一覧 | `/pets` | 登録済みペットを一覧表示し、ダッシュボードへ遷移 | 詳細へ、追加へ、編集へ | pets |
| S03 | ペット登録/編集 | `/pets/new` `/pets/:petId/edit` | ペット基本情報の登録・編集 | 保存、キャンセル | pets |
| S04 | ペットダッシュボード（ハブ） | `/pets/:petId` | ペット単位で「通院/体重/投薬/履歴」へ誘導する中心画面 | 各領域一覧へ、追加へ、ペット編集へ | pets / records（サマリ） |
| S05 | 履歴（タイムライン：records一覧） | `/pets/:petId/history` | 体調/体重/投薬/通院を「日付」でまとめて振り返る | フィルタ、記録詳細へ | records（一覧） |
| S06 | 記録詳細（1日まとめ：records詳細） | `/pets/:petId/records/:recordId` | その日の記録（体調+子要素）をまとめて閲覧 | 編集へ、削除へ | records（詳細） |
| S07 | 通院一覧 | `/pets/:petId/vet-visits` | 通院（診療）を時系列で一覧表示し、詳細/登録へ誘導 | 追加へ、詳細へ | record_vet_visits（一覧） |
| S08 | 通院登録/編集 | `/pets/:petId/vet-visits/new` `/pets/:petId/vet-visits/:visitId/edit` | 通院を入力（入力しやすさ最優先） | 保存、キャンセル、削除 | record_vet_visits |
| S09 | 通院詳細 | `/pets/:petId/vet-visits/:visitId` | 通院の閲覧を最適化（診断・費用・メモ等） | 編集へ、削除へ | record_vet_visits |
| S10 | 体重一覧 | `/pets/:petId/weights` | 体重を時系列で確認（将来：グラフ） | 追加へ、編集へ | record_weights |
| S11 | 体重登録/編集 | `/pets/:petId/weights/new` `/pets/:petId/weights/:weightId/edit` | 体重をサクッと入力（1分以内） | 保存、キャンセル、削除 | record_weights |
| S12 | 投薬一覧 | `/pets/:petId/medications` | 投薬履歴/継続中を一覧で確認 | 追加へ、編集へ | record_medications |
| S13 | 投薬登録/編集 | `/pets/:petId/medications/new` `/pets/:petId/medications/:medId/edit` | 投薬を入力（期間/頻度/メモ） | 保存、キャンセル、削除 | record_medications |
| S14 | 今日のまとめて記録（任意ショートカット） | `/pets/:petId/records/new` `/pets/:petId/records/:recordId/edit` | 1画面でまとめて入力（従来S05相当） | 保存、キャンセル、削除 | records / record_* |

---

## 5. MVPでの「最優先導線」（改訂）
- **S01（ホーム）→ S04（ペットダッシュボード）** を基本導線
- S04から目的別に分岐  
  - 通院：S07 → S08 → S09  
  - 体重：S10 → S11  
  - 投薬：S12 → S13  
  - 振り返り：S05 → S06
- S14（まとめて記録）は「慣れてる人向け」ショートカットとして置ける（任意）

---

## 6. 画面とCRUDの対応表（概略：改訂）

| 対象 | Create | Read | Update | Delete |
|---|---|---|---|---|
| pets | S03 | S02/S04 | S03 | （任意）論理削除 |
| records（親） | S14 | S05/S06 | S14 | S06/S14（論理削除） |
| record_vet_visits | S08 | S07/S09 | S08 | S08/S09（方針：論理 or 物理） |
| record_weights | S11 | S10 | S11 | S11（方針：論理 or 物理） |
| record_medications | S13 | S12 | S13 | S13（方針：論理 or 物理） |

---

## 7. 設計メモ（実装の迷いを減らす）

### 7.1 データモデルとの整合
- 当面は `records` 親 + 子（weights/medications/vet_visits）を踏襲する  
  → 領域別登録（S08/S11/S13）でも、内部的には「recordsを作って子を1件追加」でも成立する。

### 7.2 “通院が主役”のための追加検討（任意）
- 通院を完全に主役にするなら、通院テーブルに `visited_on`（受診日）を追加する案もある  
  （後追い入力や再診管理に強くなる）

### 7.3 ルーティング命名
- `history` は “records一覧（まとめ）” の意味で固定  
- 領域別は `vet-visits / weights / medications` を統一し、URLから用途が即理解できるようにする
