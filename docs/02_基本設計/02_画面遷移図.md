# 02_画面遷移図（改訂版：領域別ページ設計）

## 1. 目的
本ドキュメントは、ペットカルテアプリ（MVP）における画面遷移を可視化し、  
ユーザーが「どこから何ができるか」を迷わない導線として固定することを目的とする。

---

## 2. 改訂の背景（要点）
- ホーム（S01）を **全体ダッシュボード** とし、ペットごとの状況を俯瞰して領域別へ誘導する
- ペット単位の **ダッシュボード（S04）** をハブとして、通院/体重/投薬/履歴へ分岐させる
- 通院/体重/投薬は **一覧 → 登録/編集 → 詳細（通院）** の領域別フローを持つ
- 従来の「まとめて記録（S14）」は **任意のショートカット** として残す

---

## 3. 画面遷移（全体）

```mermaid
flowchart TD
  %% =======================
  %% Global / Home
  %% =======================
  S01[/"S01 ホーム（全体ダッシュボード）"/]

  S02["S02 ペット一覧"]
  S03["S03 ペット登録/編集"]

  %% =======================
  %% Pet Hub
  %% =======================
  S04["S04 ペットダッシュボード（ハブ）"]

  %% =======================
  %% History (records)
  %% =======================
  S05["S05 履歴（タイムライン：records一覧）"]
  S06["S06 記録詳細（1日まとめ：records詳細）"]
  S14["S14 今日のまとめて記録（任意ショートカット）"]

  %% =======================
  %% Vet Visits (main)
  %% =======================
  S07["S07 通院一覧"]
  S08["S08 通院登録/編集"]
  S09["S09 通院詳細"]

  %% =======================
  %% Weights
  %% =======================
  S10["S10 体重一覧"]
  S11["S11 体重登録/編集"]

  %% =======================
  %% Medications
  %% =======================
  S12["S12 投薬一覧"]
  S13["S13 投薬登録/編集"]

  %% -----------------------
  %% Home -> Pets
  %% -----------------------
  S01 -->|ペットカード選択| S04
  S01 -->|ペット一覧へ| S02
  S02 -->|ペット追加| S03
  S02 -->|ペット選択| S04
  S04 -->|ペット編集| S03

  %% -----------------------
  %% Hub branching
  %% -----------------------
  S04 -->|通院を見る| S07
  S04 -->|体重を見る| S10
  S04 -->|投薬を見る| S12
  S04 -->|履歴を見る| S05
  S04 -->|まとめて記録（任意）| S14

  %% -----------------------
  %% History flow
  %% -----------------------
  S05 -->|記録を選択| S06
  S06 -->|編集| S14
  S14 -->|保存| S06
  S14 -->|キャンセル| S04

  %% -----------------------
  %% Vet visits flow
  %% -----------------------
  S07 -->|通院追加| S08
  S07 -->|通院を選択| S09
  S09 -->|編集| S08
  S08 -->|保存| S09
  S08 -->|キャンセル| S07

  %% -----------------------
  %% Weights flow
  %% -----------------------
  S10 -->|体重追加| S11
  S10 -->|体重編集| S11
  S11 -->|保存| S10
  S11 -->|キャンセル| S10

  %% -----------------------
  %% Medications flow
  %% -----------------------
  S12 -->|投薬追加| S13
  S12 -->|投薬編集| S13
  S13 -->|保存| S12
  S13 -->|キャンセル| S12
```

---

## 4. 主要導線（MVPで最優先）

### 4.1 通院（主役）
- S01 → S04 → S07 → S08 → S09  
  - 迷いポイントを減らすため、S04に「通院追加」ボタンも置く（S08へ直通でも良い）

### 4.2 体重（サクッと入力）
- S01 → S04 → S10 → S11 → S10

### 4.3 投薬（継続/履歴）
- S01 → S04 → S12 → S13 → S12

### 4.4 まとめて振り返り（横断）
- S01 → S04 → S05 → S06

### 4.5 まとめて記録（任意ショートカット）
- S01 → S04 → S14 → S06

---

## 5. 実装メモ（迷いを減らすためのルール）

- S04（ハブ）には必ず「通院/体重/投薬/履歴」へのボタンを持たせる
- 通院は「一覧→詳細→編集」が自然。体重/投薬は詳細ページを作らず「一覧→編集」でMVP可
- S14（まとめて記録）はMVPの必須導線から外しても成立する（ただし既存設計互換のため残す）

